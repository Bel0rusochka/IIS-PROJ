{% extends "base.html" %}

{% block title %}Groups{% endblock %}

{% block content %}
  	<div class="groups">
		<a href="{{ url_for('index') }}">
            <img class="back-button" alt="Back" src="../static/images/arrow2.svg" id="arrowIcon">
        </a>
		<div class="window-groups">
		</div>
		<div class="all-groups">
			<!-- Form for switching between My Groups and All Groups -->
			<form method="POST" action="{{ url_for('groups') }}">
				<!-- My Groups Button -->
				<input type="submit" name="my_groups" value="My Groups" id="myGroupsButton" class="butt-my-groups {{ 'active' if show_my_groups else 'passive' }}">
				
				<!-- Search Field -->
				<div class="search">
					<div class="search-text">Search...</div>
					<img class="search-icon" alt="" src="../static/images/search.svg">
				</div>
				
				<!-- All Groups Button -->
				<input type="submit" name="all_groups" value="All Groups" id="allGroupsButton" class="butt-all-groups {{ 'active' if show_all_groups else 'passive' }}">
			</form>

			<!-- Create Group Button (controlled by JavaScript) -->
			<div class="butt-create-group" id="createGroupButton">
				<div class="button">Create a group</div>
			</div>

			<!-- Loop through groups from the database -->
            <div class="groupsList" >
			{% for group in groups %}
        			<div class="group-item">
          				<img class="avatar" alt="" src="{{ group.avatar_url or 'img/default_group.png' }}">
          				<div class="name-of-group">
            				<div class="group">{{ group.name }}</div>
            				<div class="subscribers">{{ group.subscribers_count }} subscribers</div>
          				</div>
          				<div class="line"></div>
        			</div>
        		{% endfor %}
			</div>
		</div>
  	</div>

  	<!-- Popup for creating a group (still controlled by JavaScript) -->
  	<div id="createGroupContainer" class="popup-overlay" style="display:none">
    	<div class="window-create-group">
      		<div class="create-group-text">Create a group</div>
      		<div class="create-butt">
        		<div class="create">Create</div>
      		</div>
      		<div class="window-name"></div>
      		<div class="window-privacy"></div>
      		<div class="public">Public</div>
      		<div class="group-name">Group name</div>
      		<div class="group-privacy">Group privacy</div>
      		<img class="icon" alt="" src="../static/images/ChevronDownOutline.svg">
      		<div class="enter-a-name">Enter a name</div>
			<div class="privacy-options" id="privacyOptions" style="display: none;">
				<div class="privacy-option" data-privacy="public">
					Public <br>
					<span class="privacy-description">All users can view content in the group and leave comments on the wall.</span>
				</div>
				<div class="privacy-option" data-privacy="private">
					Private <br>
					<span class="privacy-description">Content is seen only by subscribers of the group. To subscribe, you need to submit an application or receive an invitation.</span>
				</div>
			</div>
    	</div>	
  	</div>

	  <script>
       // Show/hide the "create group" popup
		var createGroupButton = document.getElementById("createGroupButton");
		var createGroupPopup = document.getElementById("createGroupContainer");

		if (createGroupButton) {
		createGroupButton.addEventListener("click", function () {
			createGroupPopup.style.display = "flex";
			createGroupPopup.style.zIndex = 100;
			createGroupPopup.style.backgroundColor = "rgba(113, 113, 113, 0.3)";
			createGroupPopup.style.alignItems = "center";
			createGroupPopup.style.justifyContent = "center";
		});
		}

		// Close popup when clicked outside
		createGroupPopup.addEventListener("click", function (e) {
		if (e.target === createGroupPopup) {
			createGroupPopup.style.display = "none";
		}
		});

    </script>
{% endblock %}
