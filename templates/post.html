{% extends "base.html" %}

{% block title %}Post Details{% endblock %}

{% block content %}
  <a href="{{ url_for('index') }}" class="back-button">
    <i class="fas fa-arrow-left"></i>
  </a>

  <div id="imageDetail">
    <img alt="Image {{ post.id }}" src="{{ url_for('image', id=post.id) }}" id="selectedImage" data-id="{{ post.id }}"/>
    <div id="imageStats">
      <form action="{{ url_for('like_post', post_id=post.id) }}" method="POST">
        <input type="hidden" name="post_id" value="{{ post.id }}">
        <button type="submit" class="like-button">
          <i class="fa fa-heart"></i>
          <span>{{ post.like_count() }}</span>
        </button>
      </form>
      <span id="retweetsCount">
        <i class="fa fa-retweet"></i> {{ post.shares_count() }}
      </span>
      <span id="commentsCount">
        <i class="fa fa-comment"></i> {{ post.comments_count() }}
      </span>
    </div>

    <div id="imageTags">
      <span id="tagsList">Tags:</span>
      {% for tag in post.associated_tags %}
        <span class="tag">{{ tag.name }}</span>
      {% endfor %}
    </div>

    <div id="imageDescription">
      <h3>Description:</h3>
      <p>{{ post.text }}</p>
    </div>

    <!-- Comment Section -->
    <div id="commentSection">
      <h3>Comments:</h3>
      <form id="commentForm" action="{{ url_for('add_comment', post_id=post.id) }}" method="POST">
        <textarea id="commentInput" placeholder="Write a comment..." rows="3" cols="50" name="text"></textarea>
        <button id="submitComment">Submit</button>
      </form>
      <div id="commentsList">
        {% for comment in comments %}
          <div class="comment" style="border-bottom: 1px solid #ccc; padding: 10px;">
            <div style="font-weight: bold; color: #555;">
              {{ comment.author_login }} - <small>{{ comment.date.strftime('%Y-%m-%d %H:%M') }}</small>
            </div>
            <div style="margin-top: 5px;">
              {{ comment.text }}
            </div>
          </div>
        {% endfor %}
      </div>
    </div>
  </div>
{% endblock %}
